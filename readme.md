# 🖨️ WeChat PDF Converter

**一键抓取微信公众号文章 → 高质量PDF → 智能合并归档**  
无需复杂配置，开箱即用！支持批量处理、自动滚动加载、书签生成，是知识管理/内容归档的利器。

> ✅ 已提供打包版EXE文件，无需Python环境，Windows双击即用！

---

## 🚀 核心功能
- **批量文章抓取**：从`urls.txt`自动导入文章链接（每行一个URL）
- **智能滚动加载**：自动模拟滚动操作，完整捕获长文内容（含图片/排版）
- **高质量PDF输出**：保留原始排版，支持自定义页边距/纸张尺寸
- **一键合并+书签**：聚合所有文章为单个PDF，自动生成带序号的书签目录
- **混合处理模式**：
  - **URL模式**：仅处理链接生成PDF
  - **混合模式**：处理链接 + 合并本地已有PDF（URL生成文件优先排序）

---

## 🧰 系统要求
- **操作系统**: Windows 10/11 (64位)
- **依赖浏览器**: Microsoft Edge (需已安装)
- **磁盘空间**: ≥50MB可用空间

---

## ⬇️ 安装与使用

### 方法1：EXE打包版（推荐）
1. 下载解压`WeChatPDFConverter.zip`  
2. 创建`urls.txt`文件，写入公众号文章链接（每行一个）
3. 双击运行 `WeChatPDFConverter.exe`
4. 等待控制台提示完成，合并文件保存为 **`merged_pdfs.pdf`**

### 方法2：Python源码运行

---

## 📂 文件结构
| 文件/目录       | 说明                                                                 |
|-----------------|----------------------------------------------------------------------|
| `urls.txt`      | 输入的微信公众号链接（程序自动读取）                                 |
| `文章标题.pdf`  | 单篇文章生成的PDF（标题自动过滤非法字符）                            |
| `merged_pdfs.pdf` | 最终合并的PDF文件（含书签）                                          |
| `logs/`         | 日志目录（可选启用）                                                 |

---

## ⚙️ 配置自定义
在代码中修改以下参数：

async def wechat_to_pdf(self, url, output_path="output.pdf"):
    pdf_options = {
        'path': output_path,
        'format': 'A4',          # 可选：A3, A5, Letter...
        'printBackground': True, # 是否打印背景
        'margin': {'top':'30px', 'right':'30px', 'bottom':'30px', 'left':'30px'} # 页边距
    }

---

## 🔍 使用示例

### 场景1：批量处理公众号文章 → 合并PDF
1. 编辑`urls.txt`，添加3篇文章链接  
2. 运行程序 → 自动生成：  
   - `文章1.pdf`，`文章2.pdf`，`文章3.pdf`
   - `merged_pdfs.pdf`（含3篇文章书签）

### 场景2：混合本地PDF + 新文章
1. 将现有PDF（如`报告.pdf`）放入程序目录  
2. 运行程序（无需`urls.txt`）→ 直接合并所有PDF  
   - 输出：`merged_pdfs.pdf`（包含原有PDF+新文章）

---

## ⚡ 高级技巧
- **URL优先级控制**：URL生成的PDF始终排在合并文件前列
- **名称规范化**：标题特殊字符（`\/:*?"<>|`）自动过滤，避免文件保存失败
- **中断续传**：运行时按`Ctrl+C`安全停止，重新运行跳过已生成文件
- **无图模式**：修改代码中`printBackground=False`可加速转换（不保留背景图）

---

## ⚠️ 注意事项
1. **首次启动较慢**：需初始化浏览器内核（约10-30秒）
2. **Edge浏览器必需**：确保`C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe`路径存在
3. **长文章处理**：单篇文章超过50屏时，建议分批次处理
4. **反爬机制**：频繁操作可能触发微信反爬，建议间隔运行或更换IP
5. **内存管理**：单次处理超过10篇文章建议增加系统内存

---

## 🛠️ 技术支持
| 问题现象                | 解决方案                                                                 |
|-------------------------|--------------------------------------------------------------------------|
| 浏览器页面空白          | 检查网络连接，关闭VPN重试，等待1-2小时规避反爬机制                        |
| 生成PDF失败             | 确认Edge浏览器可正常访问公众号，更新Edge至最新版                         |
| 合并后书签错乱          | 检查所有PDF是否可正常打开，避免加密文件                                  |
| 内存不足崩溃            | 分批处理文章（修改`urls.txt`分多次运行）                                 |

> 📌 **提示**：更多问题请提交至 [Issues页面](https://github.com/yourusername/wechat-pdf-converter/issues)

---

## 📜 许可协议
本项目采用 [MIT License](LICENSE)，允许自由使用、修改及再分发。  
**请勿用于商业售卖或违反微信条款的内容采集**。  
© 2025 WeChatPDFConverter Project. 知识归档，高效始于工具。   